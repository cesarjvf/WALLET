<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suite Criptogr√°fica | Scanner Octa-Chain</title>
    <script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.min.js"></script>
    <style>
        :root {
            --bg-color: #0d0d0d;
            --terminal-green: #00ff41;
            --terminal-dim: #008F11;
            --alert-color: #ff3333;
            --warning-color: #ffcc00;
            --info-color: #00ccff; 
            --panel-bg: #1a1a1a;
            --input-bg: #222;
            
            /* Colores de Redes */
            --bsc-color: #f3ba2f; 
            --matic-color: #8247e5; 
            --avax-color: #e84142;
            --arb-color: #2d374b;
            --op-color: #ff0420;
            --base-color: #0052ff;
            --ftm-color: #1969ff;
        }

        body {
            background-color: var(--bg-color);
            color: var(--terminal-green);
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-y: auto;
        }

        header {
            text-align: center;
            margin-bottom: 10px;
            border-bottom: 1px solid var(--terminal-dim);
            width: 100%;
            max-width: 900px;
            padding-bottom: 5px;
            flex-shrink: 0;
        }

        h1 { font-size: 1.2rem; margin: 0; text-transform: uppercase; letter-spacing: 2px; }
        .subtitle { font-size: 0.7rem; color: var(--terminal-dim); }

        #workspace {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 900px;
            gap: 15px;
            margin-bottom: 20px;
        }

        #top-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #stats-panel {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .stat-box {
            border: 1px solid var(--terminal-dim);
            padding: 5px;
            text-align: center;
            background: #111;
        }

        .stat-value { font-size: 1.2rem; font-weight: bold; }
        .stat-label { font-size: 0.6rem; color: #888; text-transform: uppercase; }

        #config-panel {
            background: var(--input-bg);
            border: 1px solid #444;
            padding: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .mode-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
            margin-bottom: 5px;
        }

        .radio-label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            color: #ccc;
        }
        .radio-label:hover { color: white; }
        input[type="radio"] { accent-color: var(--terminal-green); }

        #input-area label { font-size: 0.8rem; color: var(--terminal-dim); font-weight: bold; display: block; margin-bottom: 5px;}
        
        #target-input {
            background: #000;
            border: 1px solid #555;
            color: white;
            padding: 8px;
            font-family: monospace;
            font-size: 0.9rem;
            width: 100%;
            box-sizing: border-box;
        }
        #target-input:focus { outline: none; border-color: var(--terminal-green); }

        #scan-panel {
            background-color: var(--panel-bg);
            border: 1px solid var(--terminal-dim);
            padding: 10px;
            overflow-y: auto;
            font-size: 0.8rem;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
            height: 250px;
            min-height: 150px;
        }

        #treasure-panel {
            background-color: #2a0a0a;
            border: 2px solid var(--alert-color);
            padding: 10px;
            display: flex;
            flex-direction: column;
            height: 180px;
            position: relative;
        }

        #treasure-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            color: var(--alert-color);
            font-weight: bold;
        }

        #found-keys {
            width: 100%;
            flex-grow: 1;
            background: black;
            color: var(--terminal-green);
            border: 1px solid #555;
            padding: 10px;
            font-family: monospace;
            resize: none;
            font-size: 0.8rem;
        }

        .log-entry {
            margin-bottom: 3px;
            border-bottom: 1px solid #333;
            display: flex;
            justify-content: space-between;
            align-items: center; 
            opacity: 0.8;
            padding: 2px 0;
        }
        .log-entry.found-alert { opacity: 1; font-weight: bold; background: #300; }

        .tag-type { font-size: 0.6rem; padding: 1px 4px; border-radius: 3px; margin-right: 8px; min-width: 35px; text-align: center; display: inline-block; }
        .tag-12 { background-color: #222; border: 1px solid #555; color: #ccc; }
        .tag-24 { background-color: #003366; border: 1px solid var(--info-color); color: var(--info-color); }
        .tag-key { background-color: #440044; border: 1px solid #ff00ff; color: #ff00ff; }

        .mnemonic-container { flex-grow: 1; display: flex; align-items: center; overflow: hidden; }
        .mnemonic { color: #aaa; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-right: 10px; }
        .address { color: #555; font-size: 0.75rem; width: 140px; text-align: right; flex-shrink: 0; font-family: monospace; }
        .status { width: 100px; text-align: right; flex-shrink: 0; font-size: 0.75rem; }
        .checking { color: var(--warning-color); font-style: italic; }
        
        /* Badges de Redes */
        .chain-eth { color: #fff; }
        .chain-bsc { color: var(--bsc-color); }
        .chain-poly { color: var(--matic-color); }
        .chain-avax { color: var(--avax-color); }
        .chain-arb { color: #9bb0cf; } /* Arbitrum Azul Claro */
        .chain-op { color: var(--op-color); }
        .chain-base { color: var(--base-color); }
        .chain-ftm { color: var(--ftm-color); }
        .chain-multi { color: #fff; text-shadow: 0 0 5px #fff; }

        button {
            background: transparent;
            border: 1px solid var(--terminal-green);
            color: var(--terminal-green);
            padding: 8px 20px;
            cursor: pointer;
            text-transform: uppercase;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        button:hover { background: var(--terminal-green); color: black; }
        button:disabled { border-color: #444; color: #444; cursor: not-allowed; }

        .validation-error {
            color: var(--warning-color);
            font-size: 0.8rem;
            margin-top: 5px;
            display: none;
            border: 1px solid var(--warning-color);
            padding: 5px;
        }
        
        .network-status {
            font-size: 0.7rem;
            color: #555;
            margin-top: 5px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .net-active { color: var(--terminal-green); }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--terminal-dim); }
    </style>
</head>
<body>

    <header>
        <h1>Suite Octa-Chain EVM</h1>
        <div class="subtitle">8 Redes Simult√°neas: ETH ‚Ä¢ BSC ‚Ä¢ POLY ‚Ä¢ AVAX ‚Ä¢ ARB ‚Ä¢ OP ‚Ä¢ BASE ‚Ä¢ FTM</div>
    </header>

    <div id="workspace">
        
        <div id="top-section">
            <div id="stats-panel">
                <div class="stat-box">
                    <div class="stat-value" id="count-gen">0</div>
                    <div class="stat-label">Intentos</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="speed-gen">0</div>
                    <div class="stat-label">Velocidad</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="found-count" style="color: var(--alert-color)">0</div>
                    <div class="stat-label">Hallazgos</div>
                </div>
            </div>

            <div id="config-panel">
                <div class="mode-selector">
                    <label class="radio-label">
                        <input type="radio" name="mode" value="online" checked onchange="updateUI()">
                        üì° Buscador Autom√°tico (Online)
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="mode" value="offline" onchange="updateUI()">
                        üéØ Buscador Objetivo (Offline)
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="mode" value="manual" onchange="updateUI()">
                        üîë Verificador Manual (Check)
                    </label>
                </div>

                <div id="input-area">
                    <label id="input-label">CONFIGURACI√ìN:</label>
                    <input type="text" id="target-input" placeholder="Esperando configuraci√≥n..." disabled>
                    <div id="btc-warning" class="validation-error"></div>
                    
                    <div class="network-status" id="net-status" style="display:none;">
                        Conectando a 8 redes...
                    </div>

                    <button id="btn-action" onclick="executeAction()">‚ñ∂ INICIAR ESCANEO</button>
                    <button id="btn-stop" onclick="stopMining()" disabled style="display:none;">‚èπ DETENER</button>
                </div>
            </div>
        </div>

        <div id="scan-panel">
            <div style="color: gray; text-align: center; margin-top: 50px;">
                Selecciona un modo y presiona INICIAR...
            </div>
        </div>

        <div id="treasure-panel">
            <div id="treasure-header">
                <span>CAJA DE RESULTADOS</span>
                <button onclick="copyTreasures()" style="border-color:var(--alert-color); color:var(--alert-color)">üìã Copiar Todo</button>
            </div>
            <textarea id="found-keys" readonly placeholder="Los resultados positivos aparecer√°n aqu√≠..."></textarea>
        </div>

    </div>

    <script type="module">
        import { ethers } from "https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.min.js";

        // CONFIGURACI√ìN EXPANDIDA: 8 REDES
        const CHAINS = {
            ETH:  { url: "https://eth.llamarpc.com", symbol: "ETH" },
            BSC:  { url: "https://binance.llamarpc.com", symbol: "BNB" },
            POLY: { url: "https://polygon.llamarpc.com", symbol: "MATIC" },
            AVAX: { url: "https://avalanche.llamarpc.com", symbol: "AVAX" },
            ARB:  { url: "https://arbitrum.llamarpc.com", symbol: "ETH" },
            OP:   { url: "https://optimism.llamarpc.com", symbol: "ETH" },
            BASE: { url: "https://base.llamarpc.com", symbol: "ETH" },
            FTM:  { url: "https://rpc.ftm.tools", symbol: "FTM" }
        };

        let providers = {};
        let isRunning = false;
        let generatedCount = 0;
        let startTime = 0;
        let foundCount = 0;
        let currentTarget = "";
        
        // UI Elements
        const display = document.getElementById('scan-panel');
        const countDisplay = document.getElementById('count-gen');
        const speedDisplay = document.getElementById('speed-gen');
        const foundDisplay = document.getElementById('found-count');
        const btnAction = document.getElementById('btn-action');
        const btnStop = document.getElementById('btn-stop');
        const targetInput = document.getElementById('target-input');
        const inputLabel = document.getElementById('input-label');
        const warningBox = document.getElementById('btc-warning');
        const treasureBox = document.getElementById('found-keys');
        const netStatus = document.getElementById('net-status');

        window.updateUI = function() {
            const mode = document.querySelector('input[name="mode"]:checked').value;
            warningBox.style.display = 'none';
            btnStop.style.display = 'none';
            btnAction.style.display = 'inline-block';
            btnAction.disabled = false;
            netStatus.style.display = 'none';

            if (mode === 'online') {
                inputLabel.innerText = "MODO AUTOM√ÅTICO (8 Redes):";
                targetInput.placeholder = "Generaci√≥n autom√°tica.";
                targetInput.disabled = true;
                targetInput.value = "";
                btnAction.innerText = "‚ñ∂ INICIAR MINER√çA";
                btnStop.style.display = 'inline-block';
            } 
            else if (mode === 'offline') {
                inputLabel.innerText = "DIRECCI√ìN OBJETIVO (EVM):";
                targetInput.placeholder = "0x...";
                targetInput.disabled = false;
                targetInput.value = "0xdadb0d80178819f2319190d340ce9a924f783711";
                btnAction.innerText = "‚ñ∂ INICIAR B√öSQUEDA";
                btnStop.style.display = 'inline-block';
            } 
            else if (mode === 'manual') {
                inputLabel.innerText = "VERIFICADOR MANUAL:";
                targetInput.placeholder = "0x... o Semilla";
                targetInput.disabled = false;
                targetInput.value = "";
                btnAction.innerText = "üîé VERIFICAR EN 8 REDES";
            }
        };

        async function initProviders() {
            if (Object.keys(providers).length > 0) return;
            
            netStatus.style.display = 'flex';
            netStatus.innerHTML = "<span>Iniciando conexi√≥n a 8 blockchains...</span>";
            
            // Inicializar en paralelo pero sin bloquear
            const keys = Object.keys(CHAINS);
            for (const key of keys) {
                try {
                    providers[key] = new ethers.JsonRpcProvider(CHAINS[key].url);
                } catch(e) { console.error(`Error init ${key}`); }
            }
            netStatus.innerHTML = `<span class="net-active">‚úÖ Conectado a: ${keys.join(", ")}</span>`;
        }

        window.executeAction = async function() {
            const mode = document.querySelector('input[name="mode"]:checked').value;
            
            if (mode !== 'offline') {
                btnAction.disabled = true;
                btnAction.innerText = "Conectando...";
                await initProviders();
                btnAction.disabled = false;
            }

            if (mode === 'manual') {
                await checkManualKey();
            } else {
                startMining(mode);
            }
        };

        async function checkManualKey() {
            const input = targetInput.value.trim();
            if (!input) return alert("Ingresa una clave o semilla.");
            
            display.innerHTML = '';
            btnAction.disabled = true;
            btnAction.innerText = "ESCANEANDO...";
            
            let wallet;
            let typeTag = "";

            try {
                if (input.includes(" ")) {
                    wallet = ethers.Wallet.fromPhrase(input);
                    typeTag = input.split(" ").length + "W";
                } else if (input.startsWith("0x") || input.length === 64 || input.length === 66) {
                    const pk = input.startsWith("0x") ? input : "0x" + input;
                    wallet = new ethers.Wallet(pk);
                    typeTag = "KEY";
                } else {
                    throw new Error("Formato inv√°lido.");
                }

                const div = logWallet(input.substring(0,20)+"...", wallet.address, false, true, typeTag);
                
                // Escaneo masivo en paralelo (Promise.allSettled es mejor para que no falle todo si uno falla)
                const promises = Object.keys(providers).map(async (key) => {
                    try {
                        const bal = await providers[key].getBalance(wallet.address);
                        return { key, bal, sym: CHAINS[key].symbol };
                    } catch(e) { return { key, bal: 0n, sym: "" }; }
                });

                const results = await Promise.all(promises);
                let foundTexts = [];
                let totalFound = 0;

                results.forEach(res => {
                    if (res.bal > 0n) {
                        foundTexts.push(`${formatBal(res.bal, res.sym)} (${res.key})`);
                        totalFound++;
                    }
                });

                let resultText = "0.00";
                let isRich = totalFound > 0;

                if (isRich) {
                    resultText = foundTexts.join(" + ");
                    saveToTreasureBox("MANUAL CHECK", wallet.address, wallet.privateKey, resultText);
                    alert("¬°SALDO ENCONTRADO! " + resultText);
                } else {
                    resultText = "VAC√çA (0.00)";
                }

                updateLogEntry(div, isRich, resultText, isRich ? wallet.privateKey : input);

            } catch (e) {
                alert("Error: " + e.message);
            }
            
            btnAction.disabled = false;
            btnAction.innerText = "üîé VERIFICAR EN 8 REDES";
        }

        window.startMining = function(mode) {
            if (isRunning) return;

            if (mode === 'offline') {
                currentTarget = targetInput.value.trim();
                if (!currentTarget.startsWith('0x')) {
                    warningBox.innerText = "‚ö†Ô∏è Error: Solo direcciones EVM (0x...).";
                    warningBox.style.display = 'block';
                    return;
                }
            }

            isRunning = true;
            btnAction.disabled = true;
            btnStop.disabled = false;
            targetInput.disabled = true;
            document.querySelectorAll('input[type="radio"]').forEach(r => r.disabled = true);
            
            display.innerHTML = ''; 
            startTime = Date.now();
            miningLoop(mode);
        };

        window.stopMining = function() {
            isRunning = false;
            btnAction.disabled = false;
            btnStop.disabled = true;
            targetInput.disabled = false;
            document.querySelectorAll('input[type="radio"]').forEach(r => r.disabled = false);
            speedDisplay.innerText = "0";
            updateUI(); 
        };

        async function miningLoop(mode) {
            if (!isRunning) return;

            // Online es m√°s lento por las llamadas a red (ahora son 8!)
            const loops = (mode === 'online') ? 1 : 10; 

            for (let i = 0; i < loops; i++) {
                if (!isRunning) break;

                try {
                    const entropyBytes = Math.random() > 0.5 ? 16 : 32; 
                    const is24Words = entropyBytes === 32;
                    const mnemonicObj = ethers.Mnemonic.fromEntropy(ethers.randomBytes(entropyBytes));
                    const wallet = ethers.Wallet.fromPhrase(mnemonicObj.phrase);
                    
                    let isMatch = false;
                    let balanceInfo = "0.00";

                    if (mode === 'online') {
                        const tempDiv = logWallet(mnemonicObj.phrase, wallet.address, false, true, is24Words ? "24W" : "12W");
                        
                        try {
                            // Consultar 8 redes
                            const promises = Object.keys(providers).map(async (key) => {
                                try {
                                    const bal = await providers[key].getBalance(wallet.address);
                                    if(bal > 0n) return { found: true, text: formatBal(bal, CHAINS[key].symbol), chain: key };
                                } catch(e) {}
                                return null;
                            });

                            const results = await Promise.all(promises);
                            const hit = results.find(r => r && r.found);

                            if (hit) {
                                isMatch = true;
                                balanceInfo = `${hit.text} (${hit.chain})`;
                            }
                            
                            updateLogEntry(tempDiv, isMatch, balanceInfo, mnemonicObj.phrase);
                        } catch (e) { updateLogEntry(tempDiv, false, "ERR", mnemonicObj.phrase); }
                        
                        i = loops; 
                        // Delay un poco mayor para proteger de rate limits al ser 8 llamadas
                        await new Promise(r => setTimeout(r, 2500)); 

                    } else {
                        // OFFLINE
                        if (wallet.address.toLowerCase() === currentTarget.toLowerCase()) {
                            isMatch = true;
                            balanceInfo = "TARGET HIT";
                        }
                        logWallet(mnemonicObj.phrase, wallet.address, isMatch, false, is24Words ? "24W" : "12W");
                    }

                    generatedCount++;

                    if (isMatch) {
                        foundCount++;
                        foundDisplay.innerText = foundCount;
                        saveToTreasureBox(mnemonicObj.phrase, wallet.address, wallet.privateKey, balanceInfo);
                        alert("¬°EXITO! Saldo en: " + balanceInfo);
                        if(mode === 'online') stopMining(); 
                    }

                } catch (err) { console.error(err); }
            }

            updateStats();
            if (isRunning) setTimeout(() => miningLoop(mode), mode === 'online' ? 100 : 0);
        }

        function formatBal(wei, symbol) {
            return parseFloat(ethers.formatEther(wei)).toFixed(4) + " " + symbol;
        }

        function logWallet(text, address, winner, isPending, tag) {
            const div = document.createElement('div');
            div.className = winner ? 'log-entry found-alert' : 'log-entry';
            
            const shortAddr = address.substring(0,6) + "..." + address.substring(38);
            const shortText = text.length > 30 ? text.substring(0, 25) + "..." : text;
            
            let status = winner ? '!!! SI !!!' : '0.00';
            if (isPending) status = '<span class="checking">Scan...</span>';

            let tagClass = 'tag-12';
            if(tag === '24W') tagClass = 'tag-24';
            if(tag === 'KEY') tagClass = 'tag-key';

            div.innerHTML = `
                <div class="mnemonic-container">
                    <span class="tag-type ${tagClass}">${tag}</span>
                    <span class="mnemonic">${shortText}</span>
                </div>
                <span class="address">${shortAddr}</span>
                <span class="status">${status}</span>
            `;
            
            display.prepend(div);
            if (display.children.length > 30) display.removeChild(display.lastChild);
            return div;
        }

        function updateLogEntry(div, winner, text, fullText) {
            const statusSpan = div.querySelector('.status');
            if (winner) {
                div.className = 'log-entry found-alert';
                div.querySelector('.mnemonic').innerText = fullText; 
                statusSpan.innerHTML = `<strong>${text}</strong>`;
                
                // Colorear seg√∫n cadena
                if(text.includes("ETH")) statusSpan.classList.add("chain-eth");
                else if(text.includes("BNB")) statusSpan.classList.add("chain-bsc");
                else if(text.includes("MATIC")) statusSpan.classList.add("chain-poly");
                else if(text.includes("AVAX")) statusSpan.classList.add("chain-avax");
                else if(text.includes("FTM")) statusSpan.classList.add("chain-ftm");
                else statusSpan.classList.add("chain-multi");

            } else {
                statusSpan.innerText = text;
            }
        }

        function saveToTreasureBox(source, address, privKey, balance) {
            const entry = `
[${new Date().toLocaleTimeString()}] !!! HALLAZGO MULTI-CADENA !!!
--------------------------------------------------
SALDO:    ${balance}
ORIGEN:   ${source.length > 50 ? "SEMILLA" : "MANUAL KEY"}
ADDRESS:  ${address}
DATA:     ${source}
PRIVKEY:  ${privKey}
--------------------------------------------------
\n`;
            treasureBox.value += entry;
            treasureBox.scrollTop = treasureBox.scrollHeight;
        }

        function updateStats() {
            countDisplay.innerText = generatedCount.toLocaleString();
            const elapsed = (Date.now() - startTime) / 1000;
            if (elapsed > 0) {
                const speed = generatedCount / elapsed;
                speedDisplay.innerText = speed < 1 ? speed.toFixed(1) : Math.floor(speed);
            }
        }

        window.copyTreasures = function() {
            treasureBox.select();
            document.execCommand('copy');
            alert("Copiado al portapapeles");
        }
        
        updateUI();
    </script>
</body>
</html>
